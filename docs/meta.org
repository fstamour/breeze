:PROPERTIES:
:ID:       4836d845-7be2-4a7d-bbc5-6d7e577292c2
:END:
#+title Documentation validation

* Tags
:PROPERTIES:
:ID:       755fea16-df4d-4b87-a229-b9234b89d46b
:END:

** Tag descriptions
:PROPERTIES:
:ID:       31aae436-bbf1-4fe0-b1fb-13905ddeed22
:END:

#+NAME: tags
| Tag name     | Tag description                                                                               |
|--------------+-----------------------------------------------------------------------------------------------|
| 3rd_parties  | Relating to a third-party, e.g. an external library.                                          |
| obsolete     | This task is now obsolete.                                                                    |
| doc          | Relating to the documentation.                                                                |
| ux           | This task is about improving the user experience                                              |
| test         | This task is about testing                                                                    |
| ops          | This task is about CI, releases, deploying docs, etc.                                         |
| easy         | This task should be easy                                                                      |
| bug          | This is an unintended bug                                                                     |
| editor       | This task relates to the integration with an editor.                                          |
| config       | Relating to breeze's configuration and setup.                                                 |
| refactor     | Relating to breeze's refactoring facilities.                                                  |
| capture      | Relating to breeze's capture feature.                                                         |
| quickproject | Relating to quickproject integration.                                                         |
| tech_debt    | Due to an ongoing refactoring, to an old hack, incomplete implementation, missing tests, etc. |
| reader       | Relating to breeze.reader.                                                                    |
| noexport     | org-mode internal tag                                                                         |


** Make sure that all tags in the table have a description.

#+begin_src emacs-lisp :var tags=tags
  ;; (prin1-to-string (org-get-buffer-tags))
  ;; (prin1-to-string tags)

  ;; Find tags that have no descriptions
  (let ((unknown-tags
         (cl-set-difference
          (mapcar #'car (org-get-buffer-tags))
          (mapcar #'car tags)
          :test #'string=)))
    (or unknown-tags
        "All good, no tags without description found."))
#+end_src

#+RESULTS:
: All good, no tags without description found.

** Make sure all tasks have some tags

#+begin_src emacs-lisp
(defun breeze-tasks-find-untagged-nodes ()
  "Find all \"TODO\" nodes that don't have any tags."
  (org-roam-db-query [:select
                      [id title todo file pos]
                      :from nodes
                      :where (and (= todo "TODO")
                                  (not-in id [:select [node-id] :from tags]))]))

;; Visit the first untagged task, if any
(if-let ((untagged-tasks (breeze-tasks-find-untagged-nodes)))
    (cl-destructuring-bind (id title todo file pos)
        (cl-first untagged-tasks)
      (org-roam-node-visit
       (org-roam-node-create :id id :file file :point pos)))
  (message "No untagged tasks found!"))
#+end_src

#+RESULTS:

See https://github.com/ahmed-shariff/org-roam-ql - "Query language for
org-roam".


* TODO Make sure that all org file have a front-matter
:PROPERTIES:
:ID:       eb6f8b43-ee41-46f6-b23a-bcde610dc60c
:END:

For example:

#+begin_example
:PROPERTIES:
:ID:       13ea055e-4715-4583-811b-bff78ca300ee
:END:
,#+title: Candidate Features
#+end_example

* TODO Make sure that all pages are reachable from another page

#+begin_src emacs-lisp
(dolist (row (org-roam-db-query [:select
                      [id properties file pos title]
                      :from nodes
                      :where (= todo "TODO")]))
  (cl-destructuring-bind (id properties file pos title)
      row
    (unless (assoc-string "TAGS" properties)
      (message "Node %S %S doesn't have any tags." id title))))
#+end_src


* Local variables :noexport:
# local variables:
# org-confirm-babel-evaluate: nil
# end:
